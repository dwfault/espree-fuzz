// Owner: Christian Holler
// flag: --expose_gc
// v8 version: 3.21.18, ia32

function o0() {
	var o1 = [];
	for (var o3 = []; o2 < 125000; o2++)
		o1.push(o2);
	return Array.apply(Array, o1);
}

/*
 * Sematically equivalent.
 * function boom() {
 *    var args = [];
 *    for (var i=0; i<125000; i++)
 *      args.push(i);
 *    var args2 = [];
 *    for (var i=0; i<125000; i++)
 *      args2.push(i);
 *    return args2;
 * }
 * */

var o3 = o0();
function o4(o5) {
	var o6 = 0, o7 = 1;
	for (; o5 > 0; o5 = o5 -1) {
		o6 + o7;
		o6 = o3;
	}
}
o4(75); // --> fib(10) also generates crash.

/*
    GC corruption.
    
    in src/store-buffer.cc, line 227 
    void storeBuffer::ExemptPopularPages(step, threshold)
        ....

	int old_counter = containing_chunk->store_buffer_counter();
	if (old_counter == threshold) { // --> old_counter >= threshold
            containing_chunk->set_scan_on_scavenge(true);
	    created_new_scan_on_scavenge_pages = true;
	}

        ....

    ref: jayconrod.com/posts/55/a-tour-of-v8-garbage-collection
*/
